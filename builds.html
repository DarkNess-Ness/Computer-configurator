<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Мои сборки</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap" rel="stylesheet">
  <style>
    * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            background-color: #0B0C10;
            color: #C5C6C7;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 50px;
            border-bottom: 1px solid #45A29E;
        }
        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
        }
        .logo {
            width: 75px;
            height: 75px;
        }

        .title {
            font-size: 64px;
            color: #66FCF1;
            text-shadow: 0 0 20px rgba(102, 252, 241, 0.64);
            font-weight: 900;
            text-align: center;
        }
        .site-title {
            font-size:40px;
            font-weight: 900;
            color: #66FCF1;
            text-shadow: 0 4px 20px rgba(102, 252, 241, 0.64);
        }
        .profile-btn {
            background-color: #66FCF1;
            color: #0B0C10;
            border: none;
            padding: 16px 40px; 
            border-radius: 100px;
            font-weight: 900;
            font-size: 25px; 
            cursor: pointer;
            transition: all 0.3s;
            min-width: 140px; 
            text-align: center;
        }

        .profile-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #66FCF1;
        }
    .btn {
      padding: 12px 30px;
      background: #66FCF1;
      color: #0B0C10;
      font-size: 18px;
      font-weight: bold;
      border: none;
      border-radius: 100px;
      cursor: pointer;
      box-shadow: 0 0 10px #66FCF1;
    }
    .btn:hover {
      box-shadow: 0 0 20px #66FCF1;
    }
    h2 {
      color: #66FCF1;
      margin-bottom: 20px;
      font-size: 32px;
    }
    .builds-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 20px;
    }
    .build-card {
      background: #1F2833;
      border-radius: 20px;
      padding: 20px;
      width: 300px;
      box-shadow: 0 4px 20px rgba(102, 252, 241, 0.2);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .build-card h3 {
      color: #66FCF1;
      font-size: 22px;
      margin-bottom: 10px;
    }
    .build-card ul {
      list-style: none;
      padding-left: 0;
      font-size: 14px;
      margin-bottom: auto;
    }
    .build-card li {
      margin-bottom: 5px;
    }
    .actions {
      display: flex;
      gap: 10px;
      margin-top: auto;
    }
    .actions button {
      flex: 1;
      padding: 10px;
      border-radius: 100px;
      font-weight: bold;
      font-size: 14px;
      border: none;
      cursor: pointer;
    }
    .btn-edit {
      background: #45A29E;
      color: #0B0C10;
    }
    .btn-delete {
      background: #FF4C4C;
      color: #0B0C10;
    }
    .profile-btn {
            background-color: #66FCF1;
            color: #0B0C10;
            border: none;
            padding: 16px 40px; 
            border-radius: 100px;
            font-weight: 900;
            font-size: 25px; 
            cursor: pointer;
            transition: all 0.3s;
            min-width: 140px; 
            text-align: center;
        }

        .profile-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #66FCF1;
        }
  </style>
</head>
<body>

<header>
    <div class="header-left" onclick="location.href='index.html'">
      <img src="images/logo.png" class="logo" alt="Логотип">
      <span class="site-title">ЖЕЛЕЗНЫЙ ТЮНЕР</span>
    </div>
    <div class="header-left" onclick="location.href='profile.html'">
    <button class="profile-btn">ПРОФИЛЬ</button>
  </header>

<h2 style="text-align: center; margin-bottom: 20px;">Мои сборки</h2>
<!-- Добавьте в <body>, после <h2> -->
<div style="display: flex; justify-content: center; margin-top: 10px; gap: 10px;">
  <input
    type="text"
    id="searchInput"
    placeholder="Поиск"
    style="width: 40%; padding: 10px; font-size: 16px; border-radius: 10px; border: none;"
  />
  <select id="sortSelect" style="padding: 10px; font-size: 16px; border-radius: 10px; border: none;">
    <option value="az">А–Я</option>
    <option value="za">Я–А</option>
  </select>
</div>

<div class="builds-container" id="buildsContainer"></div>

<script>
  const profile = JSON.parse(localStorage.getItem('userProfile') || '{}');
  const builds = Array.isArray(profile.builds) ? profile.builds : [];
  const buildsContainer = document.getElementById("buildsContainer");
  const searchInput = document.getElementById("searchInput");

  function renderBuilds() {
  const searchTerm = document.getElementById("searchInput").value.toLowerCase();
  const sortOrder = document.getElementById("sortSelect").value;

  buildsContainer.innerHTML = "";

  let filteredBuilds = builds
    .filter(build => (build.name || "").toLowerCase().includes(searchTerm))
    .sort((a, b) => {
      const nameA = (a.name || '').toLowerCase();
      const nameB = (b.name || '').toLowerCase();
      return sortOrder === "az" ? nameA.localeCompare(nameB) : nameB.localeCompare(nameA);
    });

  if (filteredBuilds.length === 0) {
    buildsContainer.innerHTML = "<p>Сборки не найдены.</p>";
    return;
  }

  filteredBuilds.forEach((build, index) => {
    const card = document.createElement("div");
    card.className = "build-card";

    const components = Object.entries(build.components || {}).map(
      ([key, val]) => `<li><b>${key}:</b> ${val.name || '—'}</li>`
    ).join("");

    card.innerHTML = `
      <h3>${build.name || 'Без названия'}</h3>
      <ul>${components}</ul>
      <div class="actions">
        <button class="btn-edit" onclick="editBuild(${index})">Редактировать</button>
        <button class="btn-delete" onclick="deleteBuild(${index})">Удалить</button>
      </div>
    `;

    buildsContainer.appendChild(card);
  });
}


  function saveBuilds() {
    profile.builds = builds;
    localStorage.setItem('userProfile', JSON.stringify(profile));
  }

  function deleteBuild(index) {
    if (confirm("Удалить сборку?")) {
      builds.splice(index, 1);
      saveBuilds();
      renderBuilds(searchInput.value);
    }
  }

  function editBuild(index) {
    localStorage.setItem("editBuildIndex", index);
    profile.currentBuild = builds[index];
    localStorage.setItem("userProfile", JSON.stringify(profile));
    location.href = "index.html";
  }

  searchInput.addEventListener("input", () => {
    renderBuilds(searchInput.value);
  });

  renderBuilds();
  
  document.getElementById("searchInput").addEventListener("input", renderBuilds);
  document.getElementById("sortSelect").addEventListener("change", renderBuilds);

</script>
